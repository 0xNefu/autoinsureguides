---
import { getCollection } from "astro:content";

const VALID_PILLARS = ["auto-insurance", "accidents", "traffic-laws"];

export async function getStaticPaths() {
  const paths = [];
  
  for (const pillar of VALID_PILLARS) {
    try {
      const articles = await getCollection(pillar);
      
      for (const article of articles) {
        paths.push({
          params: {
            pillar: pillar,
            subcategory: article.data.subcategory,
            slug: article.slug
          },
          props: { article }
        });
      }
    } catch (error) {
      console.log(`No articles in ${pillar} collection yet`);
    }
  }
  
  return paths;
}

const { article } = Astro.props;
const { Content } = await article.render();
const { pillar } = Astro.params;
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{article.data.title} | AutoInsureGuides</title>
</head>
<body>
  <main>
    <article>
      <h1>{article.data.title}</h1>
      <Content />
    </article>
  </main>
</body>
</html>