---
// src/components/GatedContent.astro
interface Props {
  title?: string;
  description?: string;
}

const { title = "Premium Insurance Guide", description = "Unlock this exclusive insurance content" } = Astro.props;
---

<div class="gated-content border-2 border-yellow-400 dark:border-yellow-600 rounded-2xl p-8 bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20">
  
  <div class="text-center mb-6">
    <div class="inline-flex items-center justify-center w-16 h-16 bg-yellow-100 dark:bg-yellow-900 rounded-full mb-4">
      <span class="text-2xl">??</span>
    </div>
    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">{title}</h3>
    <p class="text-gray-600 dark:text-gray-300">{description}</p>
  </div>
  
  <!-- Email Capture Form -->
  <form class="space-y-4" id="gated-form-{Math.random().toString(36).substring(2, 9)}">
    <div>
      <input 
        type="email" 
        placeholder="Your email address" 
        required
        class="w-full px-4 py-3 border border-gray-300 dark:border-gray-700 rounded-lg dark:bg-gray-900 focus:outline-none focus:ring-2 focus:ring-yellow-500"
      />
    </div>
    <div>
      <button 
        type="submit"
        class="w-full py-3 bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 text-white font-bold rounded-lg transition-all"
      >
        Unlock Premium Content
      </button>
    </div>
  </form>
  
  <p class="text-sm text-gray-500 dark:text-gray-400 text-center mt-4">
    By submitting, you agree to receive insurance tips and offers from AutoInsureGuides.
    <a href="/privacy" class="text-yellow-600 dark:text-yellow-400 hover:underline">Privacy Policy</a>
  </p>
  
  <script>
    // Handle form submission
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('gated-form-{Math.random().toString(36).substring(2, 9)}');
      if (form) {
        form.addEventListener('submit', async (e) => {
          e.preventDefault();
          const email = form.querySelector('input[type="email"]').value;
          
          // Simulate API call
          const submitBtn = form.querySelector('button[type="submit"]');
          submitBtn.textContent = 'Unlocking...';
          submitBtn.disabled = true;
          
          // In reality, send to your email service
          await new Promise(resolve => setTimeout(resolve, 1000));
          
          // Show success and unlock content
          form.innerHTML = `
            <div class="text-center">
              <div class="text-green-500 text-3xl mb-4">?</div>
              <p class="text-gray-900 dark:text-white font-medium mb-2">Check your email!</p>
              <p class="text-gray-600 dark:text-gray-300 text-sm">We've sent the premium content to your inbox.</p>
            </div>
          `;
        });
      }
    });
  </script>
</div>
